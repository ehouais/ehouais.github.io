
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
        <script src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.3.3/require.min.js"></script>
        <link href="//cdn.rawgit.com/ehouais/charts/v0.3.1/timeline/../condensed-font.css" rel="stylesheet">
        <link href="//cdn.rawgit.com/ehouais/charts/v0.3.1/timeline/default.css" rel="stylesheet">
        <link href="README.md" rel="doc">
        <style>
            html, body {
                height: 100%;
                margin: 0;
                overflow: hidden;
                background-color: #fff;
            }
        </style>
    </head>
    <body>
        <script>
            var config = {"baseUrl":"//cdn.rawgit.com/ehouais/charts/v0.3.1/timeline","paths":{"http":"//cdn.rawgit.com/ehouais/js-data-libs/v0.3.0/http","text":"//cdnjs.cloudflare.com/ajax/libs/require-text/2.0.12/text.min","d3":"//cdnjs.cloudflare.com/ajax/libs/d3/4.2.8/d3.min","timescale":"//cdn.rawgit.com/ehouais/charts/v0.3.1/timescale","twopassresize":"//cdn.rawgit.com/ehouais/charts/v0.3.1/twopassresize"},"shim":{"ext_parser":{"exports":"parser"}}};
            config.config = {text: {useXhr: function(url, protocol, hostname, port) {
                return true; // force use of CORS for text dependencies
            }}};
            require.config(config);

            var params = (function(uri) {
                    var a = document.createElement('a');
                    a.href = uri;
                    return a.search.replace(/^\?/, '').split('&').reduce(function(obj, pair) {
                        var tokens = pair.split('=');
                        obj[tokens[0]] = decodeURIComponent(tokens[1]);
                        return obj;
                    }, {});
                })(window.location.href);
            var layout = params.layout;
            var data = params.data;

            require(['chart'], function(Chart) {
                var chart,
                    parse = function(str, uri) {

                        if (uri) data = data.replace(/\n|\r/g, '');
                        require(['ext_parser'], function(parser) {
                            try {
                                var data = parser.parse(str);
                            } catch(e) {
                                console.log('Parser error: '+e.message);
                            }
                            chart.update(data);
                        });

                    },
                    params = {margin: 0.05};


                chart = Chart(document.body, params);

                window.addEventListener('resize', chart.resize);
                if (data.match(/^(https?|data):/)) {
                    require(['http'], function(Http) {
                        Http.get(data, {}, function(data) {
                            parse(data, true);
                        }, true);
                    });
                } else {
                    parse(data);
                }
            });
        </script>
    </body>
</html>
