
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
        <script src="//cdnjs.cloudflare.com/ajax/libs/require.js/2.3.2/require.min.js"></script>
        <link href="//cdn.rawgit.com/ehouais/webviews/v0.3.0/tracker//twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
        <link href="//cdn.rawgit.com/ehouais/webviews/v0.3.0/tracker/style.css" rel="stylesheet">
    </head>
    <body>
        <script>
            var config = {"baseUrl":"//cdn.rawgit.com/ehouais/webviews/v0.3.0/tracker","paths":{"http":"//cdn.rawgit.com/ehouais/js-data-libs/v0.3.0/http","text":"//cdnjs.cloudflare.com/ajax/libs/require-text/2.0.12/text.min","jquery":"//cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min","sjcl":"//cdnjs.cloudflare.com/ajax/libs/sjcl/1.0.6/sjcl.min","webviews":"//cdn.rawgit.com/ehouais/webviews/v0.3.0/webviews","ui-utils":"//cdn.rawgit.com/ehouais/js-ui-utils/0.2.0/ui-utils"},"shim":{}};
            config.config = {text: {useXhr: function(url, protocol, hostname, port) {
                return true; // force use of CORS for text dependencies
            }}};
            require.config(config);

            require(['jquery', 'sjcl', 'webviews', 'renderer'], function($, sjcl, Webviews, renderer) {
                Webviews.data().bind(function(data, type) {
                    if (type == 'application/json') {
                        data = JSON.parse(data);
                    } else if (type == 'text/csv') {
                        var rows = data.trim().split('\n').map(function(row) {
                                return row.split(',').map(function(value) {
                                    return value.trim();
                                });
                            });
                        // First row is considered header
                        data = {
                            cols: rows.shift().map(function(value) { return {label: value}; }),
                            rows: rows
                        };
                    }
                    renderer.update(data);
                });
            });
        </script>
    </body>
</html>
